// Generated by CoffeeScript 1.4.0
(function(){var e;e=function(t,n,r){var i,s,o;o=0,s=0;while(s<n.from.line)o+=t.lineInfo(s).text.length+1,s++;o+=n.from.ch;if(n.to.line===n.from.line&&n.to.ch===n.from.ch)r.insert(o,n.text.join("\n"));else{i=n.to.ch-n.from.ch;while(s<n.to.line)i+=t.lineInfo(s).text.length+1,s++;r.del(o,i),n.text&&r.insert(o,n.text.join("\n"))}if(n.next)return e(t,n.next,r)},window.sharejs.extendDoc("attach_cm",function(t,n){var r,i,s,o;if(!this.provides.text)throw new Error("Only text documents can be attached to CodeMirror2");s=this,r=function(){return window.setTimeout(function(){var e,n;e=t.getValue(),n=s.getText();if(e!==n)return console.error("Text does not match!"),console.error("editor: "+e),console.error("ot:     "+n),t.setValue(s.getText())},0)},n?(this.del(0,s.getText().length),this.insert(0,t.getValue())):t.setValue(s.getText()),r(),o=!1,i=function(n,i){if(o)return;return e(t,i,s),r()},t.setOption("onChange",i),this.on("insert",function(e,n){return o=!0,t.replaceRange(n,t.posFromIndex(e)),o=!1,r()}),this.on("delete",function(e,n){var i,s;return o=!0,i=t.posFromIndex(e),s=t.posFromIndex(e+n.length),t.replaceRange("",i,s),o=!1,r()}),this.detach_cm=function(){return t.setOption("onChange",null),delete this.detach_cm}})}).call(this);